# DOCX 解析器状态

本文档概述了 `docx` 解析器模块的当前功能和支持进度。

## 已支持功能

解析器目前支持 DOCX 规范的以下部分：

- **文档结构**: 解析主文档内容 (`word/document.xml`)，包括完整的文档结构。
- **段落**: `<w:p>` 元素及其属性 (`<w:pPr>`)，支持段落对齐、样式等基本属性。
- **文本运行**: `<w:r>` 元素及其属性 (`<w:rPr>`)，支持文本格式如粗体、斜体、下划线等。
- **超链接**: `<w:hyperlink>` 元素，包括从关系文件 (`word/_rels/document.xml.rels`) 解析目标 URL。
- **表格**: 基础的 `<w:tbl>` 结构，包括行 (`<w:tr>`) 和单元格 (`<w:tc>`)。
- **嵌套内容**: 支持表格单元格内的段落和嵌套表格。
- **内联元素**:
  - 换行 (`<w:br>`)
  - 制表符 (`<w:tab>`)

## DOCX 文件结构支持情况

下面是标准 `.docx` 文件包中常见文件和目录的解析支持状态：

| 路径 | 描述 | 支持状态 |
| --- | --- | --- |
| `[Content_Types].xml` | 定义包中各部件的内容类型 | ✅ 已支持 (隐式) |
| `_rels/.rels` | 包级别的关系 | ✅ 已支持 (隐式) |
| `docProps/app.xml` | 应用程序特定属性 | ❌ 待开发 |
| `docProps/core.xml` | 核心元数据 (作者、标题等) | ❌ 待开发 |
| `word/document.xml` | 主文档内容 | ✅ 已支持 |
| `word/_rels/document.xml.rels` | `document.xml` 的关系 (超链接、图片等) | ✅ 已支持 |
| `word/styles.xml` | 样式定义 | 🟡 部分支持 (文件已读取，但样式尚未应用) |
| `word/numbering.xml` | 列表和编号定义 | 🟡 部分支持 (文件已读取，但未与段落关联) |
| `word/settings.xml` | 文档设置 | ❌ 待开发 |
| `word/theme/theme1.xml` | 主题信息 | ❌ 待开发 |
| `word/media/*` | 存放图片等多媒体文件 | ❌ 待开发 |
| `word/header.xml`, `word/footer.xml` | 页眉和页脚 | ❌ 待开发 |

## 当前支持进度分析

### 核心文档内容 ✅

- [x] 文档主体结构解析
- [x] 段落解析与基本属性
- [x] 文本运行解析与格式属性
- [x] 超链接解析
- [x] 表格结构解析
- [x] 内联元素（换行、制表符）

### 样式与格式 🟡

- [x] 样式文件读取 (`word/styles.xml`)
- [ ] 样式实际应用到内容
- [x] 编号定义文件读取 (`word/numbering.xml`)
- [ ] 编号与段落关联

### 文档属性 ❌

- [ ] 应用程序特定属性 (`docProps/app.xml`)
- [ ] 核心元数据 (`docProps/core.xml`)
- [ ] 文档设置 (`word/settings.xml`)
- [ ] 主题信息 (`word/theme/theme1.xml`)

### 其他功能 ❌

- [ ] 图片处理
- [ ] 页眉和页脚
- [ ] 多媒体文件处理

## 待开发功能

以下功能计划在未来进行开发：

- **图片支持**: 解析和提取嵌入式图片 (`<w:drawing>`)。
- **列表完整支持**: 通过将段落的 `<w:numPr>` 属性与 `word/numbering.xml` 中的定义相关联，完全支持有序和无序列表。
- **样式应用**: 将 `word/styles.xml` 中定义的样式（如标题级别、字体、段落格式）实际应用到解析出的内容上。
- **高级属性**: 解析表格、行和单元格的更详细属性（如边框、宽度、底纹）。
- **文档属性**: 从 `docProps/core.xml` 和 `docProps/app.xml` 读取核心元数据。
- **页眉页脚**: 解析 `word/header.xml` 和 `word/footer.xml` 中的内容。

## 技术实现

本解析器基于以下技术实现：

- 使用 `quick_xml` 库进行高性能 XML 解析
- 使用 `serde` 进行数据序列化/反序列化
- 遵循 ECMA-376 标准定义的 DOCX 格式规范